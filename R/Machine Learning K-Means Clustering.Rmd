---
title: "K-Means Clusteringk"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Ctrl+Shift+Enter*. 

```{r}
#K-Means Clustering

library(data.table)
library(ggplot2)
bike = copy(Ch5_bike_station_locations)
setDT(bike)
str(bike)
#lat is y axis
#long is x axis 
```
```{r}
#Exploring the Data
grep('NA',bike)

ggplot(bike ,aes(x=longitude ,y=latitude)) + geom_point()

#Running kmeans() Function
set.seed (123)
k3=kmeans(bike ,3) #3 is the number of clusters that you want
k3

bike[,clus3:=k3$cluster]
ggplot(bike ,aes(x=longitude ,y=latitude ,color=clus3)) + geom_point ()

```
```{r}
#clus3 is a categorical -> ordinal so it needs to be factored
bike[,clus3:= factor(clus3)]
ggplot(bike ,aes(x=longitude ,y=latitude ,color=clus3)) +
  geom_point ()

```

```{r}
#tell is the center of each of the locations 
k3$centers
```
```{r}
#makes data into a datatable 
centdt=data.table(k3$centers)
centdt

```

```{r}
#This shows where the middle each cluster is 
ggplot(bike ,aes(x=longitude ,y=latitude ,color=clus3)) +
  geom_point () + geom_point(data=centdt ,aes(x=longitude , y=latitude), colour="purple", shape=11, size =2)

```
```{r}
#rerun analysis for 2 stations 
k2 = kmeans(bike[,.(latitude ,longitude)],2)
bike[,clus2:=k2$cluster]
bike[,clus2:= factor(clus2)]
centdt2=data.table(k2$centers)
ggplot(bike ,aes(x=longitude ,y=latitude ,color=clus2)) +geom_point () +
  geom_point(data=centdt2 ,aes(x=longitude , y=latitude),colour="black", shape=19,size =2) 
```
```{r}
#2 stations vs 3 
ggplot(bike ,aes(x=longitude ,y=latitude ,color=clus3)) +
  geom_point ()+geom_point(data=centdt ,aes(x=longitude , y=latitude), colour="purple", shape=11,size =2)+geom_point(data=centdt2 ,aes(x=longitude , y=latitude), colour="black", shape =19,size =2)

```

```{r}

ggplot(bike ,aes(x=longitude ,y=latitude ,color=clus3)) +
  geom_point () + geom_point(data=centdt ,aes(x=longitude , y=latitude), colour="purple", shape=11,size =2)+geom_point(data=centdt2 ,aes(x=longitude , y=latitude), colour="black", shape =19,size =2) +facet_wrap(~clus2)

```



